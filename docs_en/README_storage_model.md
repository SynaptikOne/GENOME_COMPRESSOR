#------------------------------------------------------------------------------

# Copyright (c) 2025 Rakotondravelo Tahina MickaÃ«l
# All rights reserved.
#
# This file is part of the GENOME_COMPRESSOR project.
#
# Licensed under the MIT License. You may obtain a copy of the License at:
# https://opensource.org/licenses/MIT
#------------------------------------------------------------------------------

# Module `storage_model.py`

---

## Description

This module centralizes input/output operations for `.dna` files generated by the **GENOME_COMPRESSOR** project.  
It ensures that the compressed data (genes, blocks, metadata) is saved in a structured, readable, and future-compatible format.

---

## Main Functions

- `StorageModel.save(data: dict, filename: str)`  
  Saves the compressed data to a `.dna` file in JSON format with indentation.

- `StorageModel.load(filename: str) -> dict`  
  Loads an existing `.dna` file and returns its content as a Python dictionary.

---

## `.dna` File Format Specifications

`.dna` files must contain the following three keys:

- `"genes"`: a dictionary of reference DNA sequences (`G0`, `G1`, etc.)  
- `"blocks"`: a list of compressed blocks containing gene names and associated mutations  
- `"metadata"`: general information, including `original_length`, `block_size`, and `format_version`

### Example:

```json
{
  "genes": {
    "G0": "ACGTACGT"
  },
  "blocks": [
    {
      "gene": "G0",
      "mutation": "Mut_0_A"
    }
  ],
  "metadata": {
    "original_length": 8,
    "block_size": 4,
    "format_version": "1.0"
  }
}


Unit Tests

Associated tests are defined in tests/test_storage_model.py and verify:

    Correct creation of a .dna file

    Accurate reading (data read is identical to data saved)

    Detection of malformed JSON errors


Command-line Execution (Demo Mode)

python3 src/storage_model.py


This mode tests saving and reading dummy data to/from a file named test_output.dna.

Current Format Version

"format_version": "1.0"


License

This module is part of the open source GENOME_COMPRESSOR project.

